\let\beamer@storesize\@currsize
\newdimen\beamer@sidebarwidth
\newdimen\beamer@headheight
\usebeamerfont{frametitle}
\beamer@sidebarwidth=2.5\baselineskip
\beamer@headheight=2.5\baselineskip
\reset@font

\def\beamer@lefttext{left}

\DeclareOptionBeamer{hideothersubsections}[]{\beamer@nav@subsectionstyle{show/show/hide}}
\DeclareOptionBeamer{hideallsubsections}[]{\beamer@nav@subsectionstyle{hide}}

\DeclareOptionBeamer{width}{\beamer@sidebarwidth=#1}
\DeclareOptionBeamer{height}{\beamer@headheight=#1}
\DeclareOptionBeamer{left}{\def\beamer@sidebarside{left}}
\DeclareOptionBeamer{right}{\def\beamer@sidebarside{right}}
\ExecuteOptionsBeamer{left}
\ProcessOptionsBeamer


\mode<presentation>

% Sidebar
% If width>0
\ifdim\beamer@sidebarwidth>0pt

\def\beamer@sidebarformat#1#2#3{%
	\begin{beamercolorbox}[wd=\beamer@sidebarwidth,leftskip=#1,rightskip=1ex plus1fil,vmode]{#2}
		\vbox{}%
		#3\par%
		\vbox{}%
		\vskip-1.5ex%
	\end{beamercolorbox}
}

\defbeamertemplate*{section in sidebar}{custom theme}
{%
	\vbox{%
		\vskip1ex%
		\beamer@sidebarformat{3pt}{section in sidebar}{\insertsectionhead}%
	}%
}

\defbeamertemplate*{section in sidebar shaded}{custom theme}
{%
	\vbox{%
		\vskip1ex%
		\beamer@sidebarformat{3pt}{section in sidebar shaded}{\insertsectionhead}%
	}%
}

\defbeamertemplate*{subsection in sidebar}{custom theme}
{%
	\beamer@sidebarformat{5pt}{subsection in sidebar}{\insertsubsectionhead}%
}

\defbeamertemplate*{subsection in sidebar shaded}{custom theme}
{%
	\beamer@sidebarformat{5pt}{subsection in sidebar shaded}{\insertsubsectionhead}%
}

\defbeamertemplate*{subsubsection in sidebar}{custom theme}
{%
	\beamer@sidebarformat{7pt}{subsubsection in sidebar}{\insertsubsubsectionhead}%
}

\defbeamertemplate*{subsubsection in sidebar shaded}{custom theme}
{%
	\beamer@sidebarformat{7pt}{subsubsection in sidebar shaded}{\insertsubsubsectionhead}%
}

% Sidebar
\setbeamersize{sidebar width \beamer@sidebarside=\beamer@sidebarwidth}
\defbeamertemplate*{sidebar \beamer@sidebarside}{custom theme}
{
	\beamer@tempdim=\beamer@sidebarwidth%
	\advance\beamer@tempdim by -6pt%
	{%
		\begin{beamercolorbox}[wd=\beamer@sidebarwidth]{frametitle}
			\ifx\beamer@sidebarside\beamer@lefttext%
			\else%
			\hfill%
			\fi%
			\ifdim\beamer@sidebarwidth>0pt%  
			\usebeamercolor[bg]{logo}%
			\vrule width\beamer@sidebarwidth height \beamer@headheight%
			\hskip-\beamer@sidebarwidth%
			\hbox to \beamer@sidebarwidth{\hss\vbox to
				\beamer@headheight{\vss\hbox{\color{fg}\insertlogo}\vss}\hss}%
			\else%
			\vrule width0pt height \beamer@headheight%  
			\fi%
		\end{beamercolorbox}
	}%
	{\usebeamerfont{title in sidebar}%
		\vskip1.5em%
		\hskip3pt%
		\usebeamercolor[fg]{title in sidebar}%
		Outline\par%
		\vskip1.25em%
	}%
	\insertverticalnavigation{\beamer@sidebarwidth}%
	\vfill
	\ifx\beamer@sidebarside\beamer@lefttext%
	\else%
	\usebeamercolor{normal text}%
	\llap{\usebeamertemplate***{navigation symbols}\hskip0.1cm}%
	\vskip2pt%
	\fi%
}%

\ifx\beamer@sidebarside\beamer@lefttext%
\defbeamertemplate*{sidebar right}{custom theme}
{%
	\vfill%
	\llap{\usebeamertemplate***{navigation symbols}\hskip0.1cm}%
	\vskip2pt}
\fi
\fi


% Footer
\setbeamercolor*{author in head/foot}{parent=palette tertiary}
\setbeamercolor*{title in head/foot}{parent=palette secondary}
\setbeamercolor*{date in head/foot}{parent=palette primary}

\setbeamercolor*{section in head/foot}{parent=palette tertiary}
\setbeamercolor*{subsection in head/foot}{parent=palette primary}

\setbeamertemplate{page number in head/foot}[totalframenumber]%

\defbeamertemplate*{footline}{custom theme}
{%
  \leavevmode%
  \hbox{%
  \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.25ex,dp=1ex,center]{author in head/foot}%
    \usebeamerfont{author in head/foot}\insertshortauthor\expandafter\ifblank\expandafter{\beamer@shortinstitute}{}{~~(\insertshortinstitute)}
  \end{beamercolorbox}%
  \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.25ex,dp=1ex,center]{title in head/foot}%
    \usebeamerfont{title in head/foot}\insertshorttitle
  \end{beamercolorbox}%
  \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.25ex,dp=1ex,right]{date in head/foot}%
    \usebeamerfont{date in head/foot}\insertshortdate{}\hspace*{2em}
    \usebeamercolor[fg]{page number in head/foot}\usebeamerfont{page number in head/foot}\usebeamertemplate{page number in head/foot}\hspace*{2ex} 
  \end{beamercolorbox}}%
  \vskip0pt%
}

% Margins
\setbeamersize{text margin left=1em,text margin right=1em}


\mode
<all>

\beamer@storesize
